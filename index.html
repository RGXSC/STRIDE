<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Assessment Tool  </title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --lvmh-navy: #1a2332;
            --lvmh-dark-blue: #2c3e50;
            --lvmh-gold: #c9a961;
            --lvmh-light-gold: #d4af6a;
            --lvmh-silver: #e8e8e8;
            --lvmh-white: #ffffff;
            --lvmh-accent: #8b7355;
            --lvmh-gray: #6c7a89;
            --lvmh-light-gray: #f5f6fa;
        }

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, var(--lvmh-navy) 0%, var(--lvmh-dark-blue) 100%);
    color: var(--lvmh-navy);
    line-height: 1.6;
    min-height: 100vh;
    padding: 20px;
    overflow-x: hidden;
}

.container {
    max-width: 1600px;
    margin: 0 auto;
    background: var(--lvmh-white);
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    max-height: calc(100vh - 40px);
}

header {
    background: linear-gradient(135deg, var(--lvmh-navy) 0%, #243447 100%);
    color: var(--lvmh-white);
    padding: 20px 40px;
    position: relative;
    overflow: hidden;
    flex-shrink: 0;
}

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" fill="%23c9a961" opacity="0.1"/></svg>');
            opacity: 0.1;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            width: 100px;
            height: auto;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.3));
        }

        .header-text h1 {
            font-size: 1.8em;
            font-weight: 300;
            letter-spacing: 6px;
            margin-bottom: 5px;
            background: linear-gradient(90deg, var(--lvmh-white) 0%, var(--lvmh-gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-text p {
            font-size: 0.9em;
            color: var(--lvmh-silver);
            font-weight: 300;
            letter-spacing: 1.5px;
        }

        .export-btn {
            background: linear-gradient(135deg, var(--lvmh-gold) 0%, var(--lvmh-accent) 100%);
            color: var(--lvmh-white);
            border: none;
            padding: 12px 28px;
            font-size: 0.9em;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(201, 169, 97, 0.3);
            letter-spacing: 1px;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(201, 169, 97, 0.5);
        }

.main-content {
    display: grid;
    grid-template-columns: 1fr 350px;
    gap: 0;
    flex: 1;
    overflow: hidden;
}

.assessment-panel {
    padding: 50px;
    background: var(--lvmh-white);
    overflow-y: auto;
    height: 100%;
}

.dashboard-panel {
    background: linear-gradient(180deg, var(--lvmh-light-gray) 0%, var(--lvmh-silver) 100%);
    padding: 40px 30px;
    border-left: 3px solid var(--lvmh-gold);
    overflow-y: auto;
    height: 100%;
}

        .category-section {
            margin-bottom: 50px;
            animation: fadeIn 0.6s ease;
            page-break-inside: avoid;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .category-header {
            background: linear-gradient(135deg, var(--lvmh-navy) 0%, var(--lvmh-dark-blue) 100%);
            color: var(--lvmh-white);
            padding: 20px 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .category-header::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 5px;
            background: var(--lvmh-gold);
        }

        .category-header h2 {
            font-size: 1.6em;
            font-weight: 400;
            letter-spacing: 2px;
        }

        .topic-item {
            background: var(--lvmh-white);
            border: 2px solid var(--lvmh-silver);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            page-break-inside: avoid;
        }

        .topic-item:hover {
            border-color: var(--lvmh-gold);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            transform: translateX(5px);
        }

        .topic-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .topic-title {
            font-size: 1.3em;
            font-weight: 600;
            color: var(--lvmh-navy);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .topic-badge {
            display: inline-block;
            background: var(--lvmh-gold);
            color: var(--lvmh-white);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.7em;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .maturity-levels {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .level-btn {
            background: var(--lvmh-light-gray);
            border: 2px solid var(--lvmh-silver);
            border-radius: 10px;
            padding: 20px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .level-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .level-btn:hover::before {
            left: 100%;
        }

        .level-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .level-btn.level-0 { border-color: #95a5a6; }
        .level-btn.level-1 { border-color: #e74c3c; }
        .level-btn.level-2 { border-color: #f39c12; }
        .level-btn.level-3 { border-color: #3498db; }
        .level-btn.level-4 { border-color: var(--lvmh-gold); }

        .level-btn.active {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .level-btn.level-0.active { 
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%); 
            color: white;
            border-color: #7f8c8d;
        }
        .level-btn.level-1.active { 
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); 
            color: white;
            border-color: #c0392b;
        }
        .level-btn.level-2.active { 
            background: linear-gradient(135deg, #f39c12 0%, #d68910 100%); 
            color: white;
            border-color: #d68910;
        }
        .level-btn.level-3.active { 
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); 
            color: white;
            border-color: #2980b9;
        }
        .level-btn.level-4.active { 
            background: linear-gradient(135deg, var(--lvmh-gold) 0%, var(--lvmh-accent) 100%); 
            color: white;
            border-color: var(--lvmh-accent);
        }

        .level-number {
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .level-name {
            font-size: 0.85em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .level-description {
            font-size: 0.85em;
            color: var(--lvmh-gray);
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--lvmh-silver);
            min-height: 60px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .dashboard-header h3 {
            font-size: 1.8em;
            color: var(--lvmh-navy);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .overall-score {
            background: linear-gradient(135deg, var(--lvmh-navy) 0%, var(--lvmh-dark-blue) 100%);
            color: var(--lvmh-white);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .score-value {
            font-size: 4em;
            font-weight: 300;
            margin: 10px 0;
            background: linear-gradient(90deg, var(--lvmh-white) 0%, var(--lvmh-gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .score-label {
            font-size: 0.9em;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--lvmh-silver);
        }

        .category-stats {
            margin-top: 30px;
        }

        .stat-item {
            margin-bottom: 25px;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .stat-name {
            font-weight: 600;
            color: var(--lvmh-navy);
        }

        .stat-value {
            font-weight: 700;
            color: var(--lvmh-gold);
        }

        .progress-bar {
            height: 12px;
            background: var(--lvmh-white);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--lvmh-gold) 0%, var(--lvmh-accent) 100%);
            border-radius: 10px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            to { left: 100%; }
        }

        .legend {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid var(--lvmh-silver);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.85em;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 5px;
        }

        .completion-badge {
            display: inline-block;
            background: var(--lvmh-gold);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 15px;
        }

        /* Hidden canvas for chart generation */
        #spiderChartCanvas {
            display: none;
        }

        /* PDF Specific Styles */
        @media print, .pdf-export {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                border-radius: 0;
            }

            .main-content {
                grid-template-columns: 1fr;
            }

            .dashboard-panel {
                position: static;
                height: auto;
                border-left: none;
                border-top: 3px solid var(--lvmh-gold);
                page-break-before: always;
            }

            .export-btn {
                display: none !important;
            }

            .topic-item:hover {
                transform: none;
            }

            .level-btn:hover {
                transform: none;
            }

            header {
                page-break-after: avoid;
            }

            .category-section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <header>
            <div class="header-content">
                <div class="logo-section">
           <img src="logo ATLAS.png" alt="ATLAS Logo" class="logo" id="atlasLogo">

                    <div class="header-text">
                        <h1>ATLAS </h1>
                        <p> Assessment Tool and Levers for Agile Success</p>
                    </div>
                </div>
                <button class="export-btn" onclick="exportToPDF()">
                    üìÑ Export PDF Report
                </button>
            </div>
        </header>

        <div class="main-content">
            <div class="assessment-panel" id="assessmentPanel">
                <!-- Categories will be dynamically generated here -->
            </div>

            <div class="dashboard-panel">
                <div class="dashboard-header">
                    <h3>Assessment Dashboard</h3>
                </div>

                <div class="overall-score">
                    <div class="score-label">Overall Maturity</div>
                    <div class="score-value" id="overallScore">0.0</div>
                    <div class="score-label" id="overallLevel">Not Started</div>
                </div>

                <div class="category-stats" id="categoryStats">
                    <!-- Stats will be dynamically generated here -->
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #95a5a6;"></div>
                        <span>N/A</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #e74c3c;"></div>
                        <span>‚≠ê Starting</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f39c12;"></div>
                        <span>‚≠ê‚≠ê Growing</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #3498db;"></div>
                        <span>‚≠ê‚≠ê‚≠ê Mastering</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--lvmh-gold);"></div>
                        <span>‚≠ê‚≠ê‚≠ê‚≠ê Leading</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden canvas for spider chart -->
    <canvas id="spiderChartCanvas" width="400" height="400"></canvas>

    <script>
        // Assessment Data Structure from Excel
const assessmentData = {
    "SUPPLY CHAIN / PLANNING": [
        {
            name: "S&OP Governance & Strategy",
            levels: [
                "Our organization has a regular meeting where sales, operations, and finance review demand vs. supply gaps.",
                "General Management reviews and approves the S&OP consensus demand plan at least monthly, with documented decisions (budget adjustments, capacity investments).",
                "When actual demand deviates significantly from plan, our S&OP governance triggers re-planning and resource reallocation within 2 weeks.",
                "Our S&OP enables what-if scenario planning across multiple time horizons (weekly/monthly/quarterly), with at least 3 documented strategic decisions made using these scenarios in the past 6 months."
            ]
        },
        {
            name: "Demand Forecasting",
            levels: [
                "We produce a SKU-level forecast beyond our annual budget that is updated at least quarterly.",
                "We track forecast accuracy KPIs (e.g., MAPE, bias) monthly with designated team accountability.",
                "Our demand forecasting incorporates at least 2 data signals (POS, market trends, sales/market input) using a collaborative platform, with differentiated update frequencies by product category.",
                "We use advanced analytics (statistical models, ML, external data) for forecasting, with documented reduction in stockouts OR excess inventory by at least 10% over the past 2 years."
            ]
        },
        {
            name: "Production & Capacity Planning",
            levels: [
                "We have a production plan (weekly or monthly volumes) AND documented available capacity by production unit.",
                "We update our production plan at least weekly, with a formal process ensuring demand-capacity alignment and a designated meeting chair.",
                "We can reallocate capacity or adjust production schedules within 48 hours when demand spikes, using dedicated tools (APS/scheduling software) and track both plan adherence AND flexibility KPIs.",
                "We have implemented flexible capacity mechanisms (multi-skilled workers, modular cells, supplier partnerships) that respond within 48-72 hours, with documented improvement in service level OR stock reduction by at least 10% over the past 12 months."
            ]
        },
        {
            name: "Procurement Planning",
            levels: [
                "We share a rolling procurement plan with our key suppliers (even if informal), covering at least the next 3-6 months.",
                "We track lead times for critical materials AND have documented risk management procedures (dual sourcing, safety stock, crisis protocols), with supplier performance reviews every 6 months.",
                "Procurement planning dynamically adjusts order quantities based on demand signals and production schedules, with regular cross-functional meetings (procurement, supply planning, quality) at least monthly.",
                "We have co-developed with suppliers to achieve shorter lead times OR smaller MOQs OR postponement strategies, with documented inventory reduction OR availability improvement of at least 10% over the past 12 months."
            ]
        },
        {
            name: "Inventory Management",
            levels: [
                "We have daily visibility of our inventory levels by SKU and location (including in-transit stock).",
                "We track at least 2 inventory KPIs (turnover, DOI, weeks of supply) by product category with designated ownership and at least monthly reviews.",
                "Our inventory strategy differentiates by product type (permanent/seasonal/novelties) with automatic replenishment responding to demand signals, and inventory parameters are revised at least monthly.",
                "We have shifted inventory mix to hold at least 30% in raw materials/WIP (vs. finished goods) AND documented reduction in write-offs/markdowns OR improvement in availability by at least 15% over the past 12 months, using scenario analysis."
            ]
        },
        {
            name: "Distribution Planning",
            levels: [
                "We manage distribution based on actual client orders only, or we also create a forward-looking distribution plan based on forecasted demand.",
                "A formal process ensures distribution plan alignment with production and regional forecasts, updated at least weekly, with a designated decision-maker for allocation during scarcity.",
                "We can re-plan distribution within 48 hours when demand patterns shift, using tools that enable automatic store/DC replenishment based on real-time sales data.",
                "Our distribution strategy differentiates by product type with pull-based replenishment, documented improvement in sell-through OR reduction in end-of-life stock by at least 15% over the past 12 months, AND multi-modal transport flexibility."
            ]
        }
    ],
    "PRODUCTION": [
        {
            name: "Performance Measurement",
            levels: [
                "Fundamental KPIs are measured (% accidents, schedule adherence, absenteeism, % quality, delays/advances).",
                "We measure operational KPIs at least weekly with designated responsibility for tracking.",
                "Cross-functional KPIs are measured and tracked (% client service, right first time, actual product cost, absorption by sector, OEE/TRS, Takt Time/Cycle Time).",
                "Our production performance KPIs have demonstrated measurable improvement (reduced lead times, increased quality, reduced costs) over the past 12 months, with results shared in real-time with teams through visual management."
            ]
        },
        {
            name: "Agility & Flexibility",
            levels: [
                "We know our capacity flexibility, planning frequency, production lead-time, AND have documented capacity tunnels and bottlenecks.",
                "We have a visible and updated polyvalence matrix, produce at least 20 active SKUs per month, AND track average changeover time.",
                "We can reallocate capacity within 48 hours when demand spikes for a bestseller, AND we have a formal process to challenge lead-times and MOQs at least quarterly.",
                "We have implemented modular cells or multi-skilled teams that can produce all product types and respond within 48-72 hours, with documented improvement in service rate OR stock reduction by at least 10% over the past 12 months."
            ]
        },
        {
            name: "Management & Routines",
            levels: [
                "Production routines exist. I can see where, on what medium (board, digital tool).",
                "Production has a formal shopfloor information escalation process with at least daily production meetings and weekly planning meetings with designated participants.",
                "We have documented processes for handling blocking points, track bottlenecks, anticipate problems, AND conduct Asaichi or QRQC rituals at least weekly.",
                "We have cascading production routines (daily/weekly/monthly) that enable same-day problem resolution, with at least 3 documented examples in the past 3 months."
            ]
        },
        {
            name: "Quality & Problem Solving",
            levels: [
                "We have a formal problem-solving process. We know our costs of non-quality.",
                "We have a documented quality escalation process with designated responsibility for tracking corrective actions AND defined quality objectives (regional or local).",
                "We use at least 2 structured problem-solving methods (5 Whys, Ishikawa, QRQC, Asaichi), with documented decrease in costs of non-quality over the past 12 months.",
                "Our problem-solving culture has reduced costs of non-quality by at least 10% over the past 12 months, with at least 30% of artisans/operators trained and active in problem solving."
            ]
        },
        {
            name: "Industrialization & New Product Management",
            levels: [
                "Prototypes and pre-series are identified on lines. There are resources allocated to novelty (methods, support). We know novelty flows. BOMs (nomenclatures) are accurate.",
                "We have pilot lines or prototyping workshops, a designated person managing the Development-Production interface, AND a formal BOM accuracy validation process before production.",
                "We can measure and anticipate the impact of new products on production lines (capacity, skills, tooling), AND we have a formal training process for new know-how.",
                "We have launched new products without disrupting series production in the past 6 months, with at least 3 successful launches meeting both schedule and quality targets."
            ]
        },
        {
            name: "Production Equipment / Machines",
            levels: [
                "There is machine classification. There is an autonomous and planned maintenance plan.",
                "We track machine breakdowns (frequency and downtime duration) with production impact analysis, AND have designated responsibility for maintenance.",
                "We have active breakdown/downtime reduction initiatives, AND track OEE/TRS for critical equipment with a target of at least 75%.",
                "Our predictive maintenance strategy has increased OEE/TRS by at least 10% over the past 12 months, enabling us to respond to demand spikes without additional capacity investment."
            ]
        }
    ],
    "LOGISTICS": [
        {
            name: "Lead Time E2E & Agility",
            levels: [
                "We know our end-to-end lead times from supplier to client by product category and destination.",
                "We track average lead times by flow type (raw materials, WIP, finished goods, distribution) AND document delays with root cause analysis.",
                "We can re-route flows or expedite shipments within 48 hours when disruptions occur, AND we measure the percentage of lead time that is value-add vs. wait time.",
                "We have reduced E2E lead times by at least 10% over the past 12 months through flow optimization, while maintaining or improving cost and sustainability metrics, with documented adaptation to evolving constraints."
            ]
        },
        {
            name: "Network Strategy & Footprint",
            levels: [
                "We have a clear understanding of our logistics network (production sites, DCs, cross-docks, stores) and the flows between nodes.",
                "We review our network design every 3 years, with documented triggers for optimization analysis (new market, volume change, cost pressure).",
                "We use network optimization tools to test at least 3 scenario types (demand shifts, new channels, nearshoring, sustainability), with documented multi-criteria decision framework (proximity, scale, risk).",
                "Network redesign in the past 24 months has improved service levels OR reduced costs by at least 10%, with documented mastered segregation of building, systems, automation, and operations."
            ]
        },
        {
            name: "3PL & Transport Management",
            levels: [
                "We manage transportation based on transactional relationships with many fragmented suppliers (opportunistic spot buying).",
                "We have a consolidated 3PL partner base (fewer than 10 per region/mode) AND track at least 3 performance KPIs (on-time delivery, cost, quality, sustainability).",
                "We have long-term partnerships (3+ years) with strategic 3PLs that include collaboration beyond operations (CSR, new services, geographic expansion) with incentive-aligned contracts (gain-sharing or SLA-based).",
                "Strategic 3PL partnerships have co-developed at least 2 innovations or service enhancements in the past 12 months that delivered measurable value to both parties."
            ]
        },
        {
            name: "Performance Management / KPI / Data",
            levels: [
                "We have isolated scorecards for logistics (warehouse productivity, transport cost) managed within the logistics function only.",
                "We track at least 4 logistics KPIs across the value chain (order-to-delivery time, cost-to-serve, inventory turns, transport fill rates) with at least monthly cross-functional reviews.",
                "We have real-time data visibility with dashboards/BI tools providing multilevel visibility (site, regional, global) and automated exception alerts.",
                "Scorecard automation and real-time visibility have reduced costs OR improved service levels by at least 10% over the past 12 months, using predictive analytics or AI tools."
            ]
        },
        {
            name: "Customs & Regulatory / FTA & Tax",
            levels: [                "Master data exists for customs (HS codes, country of origin), but with no dedicated resources or trade compliance team.",
                "We have a dedicated trade compliance team managing customs, regulatory requirements, and FTA programs, with at least 30% of eligible shipments leveraging FTA benefits.",
                "Our trade compliance function proactively monitors regulatory changes with impact assessments, AND has processes ensuring data accuracy (HS codes, certificates) with audit readiness.",
                "We have reduced duty costs by at least 10% through FTA leverage in the past 12 months, with at least 80% of products compliant with evolving regulations (CSRD, conflict minerals, sustainability)."
            ]
        }
    ],
    "DIRECT PROCUREMENT": [
        {
            name: "Sourcing Strategy & Supplier Portfolio",
            levels: [
                "We have a clear mapping of supplier know-how and expertise by material category/region.",
                "We have a documented sourcing strategy for each category (dual sourcing, strategic vs. tactical) with supplier count per category tracked.",
                "Our sourcing strategy formally balances at least 4 criteria (risk, cost, quality, sustainability) with documented supplier segmentation (strategic, preferred, approved) and differentiated management.",
                "Supplier portfolio optimization has reduced supply risk incidents OR improved quality by at least 10% over the past 12 months, with at least 2 documented examples supporting sustainability goals."
            ]
        },
        {
            name: "Supplier Performance & Relationship Management",
            levels: [
                "We decide which suppliers to keep or change based on defined criteria.",
                "We use supplier scorecards AND conduct business reviews with strategic suppliers at least quarterly.",
                "Our supplier performance data automatically triggers corrective action plans in our SRM system, AND we track multi-dimensional KPIs (responsiveness, innovation, sustainability).",
                "We have documented at least 2 co-development cases with suppliers in the past 12 months that resulted in measurable cost, quality, or sustainability improvements shared by both parties."
            ]
        },
        {
            name: "Traceability & Due Diligence",
            levels: [
                "We know the origin of our raw materials (country, supplier tier-1).",
                "We can trace materials back to tier-2 suppliers for critical categories, AND we have documented due diligence procedures.",
                "Our traceability system enables rapid response to quality or compliance issues, AND at least 60% of spend is covered by due diligence audits (social, environmental, ethical).",
                "We have achieved end-to-end traceability (to source/farm/mine) enabling sustainability certification or regulatory compliance, with at least 50% of materials certified (organic, fair trade, conflict-free)."
            ]
        },
        {
            name: "Sustainability & Impact Management",
            levels: [
                "We measure the environmental impact of our sourcing (CO2, water, waste).",
                "We track supplier sustainability performance AND have an action plan with reduction trajectory.",
                "Sustainability performance influences sourcing decisions (supplier selection, contract terms), AND at least 40% of spend is with suppliers meeting defined sustainability criteria.",
                "Sustainable sourcing initiatives have reduced environmental impact (CO2, water, waste) by at least 10% over the past 12 months while maintaining or improving cost and quality, with documented supplier-contributed innovations."
            ]
        },
        {
            name: "Procurement Processes & Systems",
            levels: [
                "We have documented procurement processes (RFQ, contract management, PO-to-pay).",
                "Procurement processes are digitized in a system (ERP, e-procurement platform), AND at least 70% of spend is managed through the system.",
                "Our procurement systems enable spend visibility, contract compliance, and automated workflows (approvals, PO matching), AND we use analytics to identify savings opportunities or risks.",
                "Procurement digital transformation has reduced procurement cycle time by at least 10%, increased contract compliance by at least 20%, OR identified savings of at least 10% over the past 12 months."
            ]
        }
    ],
   "SUSTAINABILITY": [
    {
        name: "Sustainable Production - Process & Impact",
        levels: [
            "We know and regularly track our environmental impacts and resource consumption (energy, water, waste).",
            "We have implemented actions to reduce the environmental impact of our production, with tracked sell-through, destruction KPIs and a resource optimization/waste reduction action plan.",
            "Our monitoring process provides precise visibility on waste management and energy consumption reduction, with regular tracking of KPIs such as water consumption/kg product, zero waste objectives, and use of hazardous substances (ZDHC).",
            "Our production is aligned with LIFE 360 creative circularity objectives, with a measurable percentage of recycled or upcycled materials in products."
        ]
    },
    {
        name: "Sustainable Sourcing - Raw Materials Strategy",
        levels: [
            "We know our critical supply chains (number and geographic origin by supply chain).",
            "Sourced raw materials are certified via Group-recommended standards (>70% of materials certified on recognized standards), with knowledge of country of origin.",
            "Raw materials are traced with a Chain of Custody (CoC) traceability tool, dedicated supplier mapping, and defined supplier tier coverage (which tier).",
            "We have defined an impact reduction action plan with our suppliers for traced and certified materials with calculated environmental impact (CO2, water, etc.)."
        ]
    },
    {
        name: "Sustainable Subcontractors & Direct Suppliers - Compliance",
        levels: [
            "We have a mapping of our value chains (from tier 1 to tier N).",
            "We have due diligence processes when onboarding new subcontractors with Code of Conduct signature (100% with DUNS and tier-2 list declared by tier-1, 100% CoC signed for strategic suppliers, due diligence including capacity checks).",
            "We implement social and environmental audits of our suppliers and operational visits (WIP capacity verification), with 100% of direct suppliers traced to tier N and 100% of subcontractors visited and audited.",
            "We implement corrective action plans for non-compliance cases (100% of subcontractors engaged in corrective action plans and 100% CoC signed)."
        ]
    },
    {
        name: "Sustainable Logistics - Operations & Transport",
        levels: [
            "We know our carbon footprint weight on transport (upstream and downstream logistics CO2 tonnage).",
            "We have a plan or initiatives to reduce our logistics carbon footprint (tracking carbon emissions, seeking lower-carbon transport solutions such as modal shift and route optimization) without formalized or measured objectives.",
            "We track the action plan and meet our objectives with a carbon transition plan including regular quantified emission reduction tracking and use of renewable energies for logistics sites.",
            "Our trajectory is aligned with LIFE 360, with Scope 3 impact tracking."
        ]
    },
    {
        name: "Sustainable Innovation - Resilience & Eco-Design",
        levels: [
            "We consider sustainability criteria when developing new products or processes, with R&D/Development teams sensitized to sustainability issues.",
            "We integrate sustainability objectives (eco-design, circularity) into our innovation projects, with specifications including environmental and social criteria.",
            "We measure the sustainable impact of our innovations (e.g.,analysis of environmental and social gains generated by innovations, such as CO2 reduction).",
            "Our innovation strategy is focused on long-term value creation and actively contributing to LIFE 360 objectives through creative circularity projects."
        ]
    },
    {
        name: "Health & Safety",
        levels: [
            "A health and safety at work policy exists (for us and our third parties), with official documentation presenting H&S policy meeting minimum legal requirements.",
            "Procedures are in place to identify and manage risks and are communicated (professional risk assessment, prevention plans, emergency procedures, and awareness campaigns).",
            "There is tracking of accidents/incidents with corrective and preventive action plans (accident/incident tracking, root cause analysis, action plans, ISO 45001 certification).",
            "Our process actively contributes to a zero-accident culture and LVMH Group H&S initiatives."
        ]
    }
],
    "PRODUCT DEVELOPMENT": [
        {
            name: "Project Management",
            levels: [
                "A minimal methodology or framework exists for managing development projects (even if informal).",
                "Development projects are systematically planned with clear objectives, timelines, and responsibilities, taking into account specific cycles (seasonal collections, permanent launches, limited editions).",
                "Project tracking tools (Gantt charts, reporting, performance indicators, Critical chain management) are used regularly and shared across teams.",
                "Post-project reviews and lessons learned are systematically conducted and integrated to improve future processes and capitalize on creative and technical know-how."
            ]
        },
        {
            name: "Costing",
            levels: [
                "A cost calculation process exists for new developments, even if basic or informal.",
                "Development costs are systematically estimated and documented before project launch, distinguishing between product typologies (novelties, variants, permanent lines).",
                "Cost estimates are regularly compared with actual costs and adjusted for subsequent projects.",
                "Cost analyses integrate optimization and continuous improvement criteria, with internal or external benchmarks. We use value analysis and target costing."
            ]
        },
        {
            name: "Quality",
            levels: [
                "Quality criteria are defined for developments, reflecting the excellence standards expected from the Maison.",
                "Quality controls are systematically performed at different stages of development.",
                "Non-conformities are tracked, analyzed, and corrective actions are implemented in a structured (for ex. AMDEC) manner.",
                "A continuous quality improvement system is in place, with indicators and shared objectives across creative, technical, and industrial teams."
            ]
        },
        {
            name: "Make or Buy",
            levels: [
                "Make or buy decisions are made, even if ad hoc or informal. We have a cartography of 'know-how' internal and for suppliers.",
                "There are defined criteria to guide make or buy decisions during development, particularly to protect strategic know-how and the Maison's identity.",
                "Make or buy decisions are documented, tracked, shared with industrial SC, and evaluated retrospectively.",
                "A strategic make or buy analysis is systematically integrated into development project management, with regular reviews and vigilance on preserving key competencies."
            ]
        },
        {
            name: "Data Management",
            levels: [
                "Development-related data (files, specs, history) are retained, even if informally or in an unstructured manner.",
                "A data management and sharing system exists to ensure traceability of development information and shared access across teams (Design, R&D, Industrialization).",
                "Data are structured, accessible, and used to manage projects and make decisions.",
                "Data are analyzed proactively to anticipate needs, optimize processes, and foster innovation."
            ]
        }
    ]
};

        // State management
        let assessmentState = {};
        let categoryScores = {};

        // Initialize assessment
        function initializeAssessment() {
            const assessmentPanel = document.getElementById('assessmentPanel');
            
            Object.keys(assessmentData).forEach(category => {
                const categorySection = document.createElement('div');
                categorySection.className = 'category-section';
                categorySection.id = `category-${category.replace(/[^a-z0-9]/gi, '-')}`;
                
                const categoryHeader = document.createElement('div');
                categoryHeader.className = 'category-header';
                categoryHeader.innerHTML = `<h2>${category}</h2>`;
                categorySection.appendChild(categoryHeader);
                
                assessmentData[category].forEach((topic, topicIndex) => {
                    const topicId = `${category}-${topicIndex}`;
                    assessmentState[topicId] = null;
                    
                    const topicItem = document.createElement('div');
                    topicItem.className = 'topic-item';
                    
                    const topicHeader = document.createElement('div');
                    topicHeader.className = 'topic-header';
                    
                    const topicTitle = document.createElement('div');
                    topicTitle.className = 'topic-title';
                    topicTitle.innerHTML = `
                        ${topic.name}
                        <span class="topic-badge">${category.split('/')[0].trim()}</span>
                    `;
                    topicHeader.appendChild(topicTitle);
                    topicItem.appendChild(topicHeader);
                    
                    const maturityLevels = document.createElement('div');
                    maturityLevels.className = 'maturity-levels';
                    
                    const levelNames = ['N/A', '‚≠ê Starting', '‚≠ê‚≠ê Growing', '‚≠ê‚≠ê‚≠ê Mastering', '‚≠ê‚≠ê‚≠ê‚≠ê Leading'];
                    
                    // Add N/A option
                    const naBtn = document.createElement('div');
                    naBtn.className = 'level-btn level-0';
                    naBtn.setAttribute('data-description', 'Not applicable - This topic does not apply to our organization and will not be included in the average calculation.');
                    naBtn.innerHTML = `
                        <div class="level-number">N/A</div>
                        <div class="level-name">Not Applicable</div>
                    `;
                    naBtn.onclick = () => selectLevel(topicId, 0, category, naBtn);
                    maturityLevels.appendChild(naBtn);
                    
                    // Add regular levels
                    topic.levels.forEach((description, levelIndex) => {
                        const level = levelIndex + 1;
                        const levelBtn = document.createElement('div');
                        levelBtn.className = `level-btn level-${level}`;
                        levelBtn.setAttribute('data-description', description);
                        levelBtn.innerHTML = `
                            <div class="level-number">${level}</div>
                            <div class="level-name">${levelNames[level]}</div>
                        `;
                        levelBtn.onclick = () => selectLevel(topicId, level, category, levelBtn);
                        maturityLevels.appendChild(levelBtn);
                    });
                    
                    topicItem.appendChild(maturityLevels);
                    
                    const levelDescription = document.createElement('div');
                    levelDescription.className = 'level-description';
                    levelDescription.id = `desc-${topicId}`;
                    levelDescription.innerHTML = '<em>Select a maturity level to see description</em>';
                    topicItem.appendChild(levelDescription);
                    
                    categorySection.appendChild(topicItem);
                });
                
                assessmentPanel.appendChild(categorySection);
                categoryScores[category] = { total: 0, count: assessmentData[category].length, naCount: 0 };
            });
            
            updateDashboard();
        }

        function selectLevel(topicId, level, category, clickedBtn) {
            // Update state
            const previousLevel = assessmentState[topicId];
            assessmentState[topicId] = level;
            
            // Update UI
            const topicElement = clickedBtn.closest('.topic-item');
            const buttons = topicElement.querySelectorAll('.level-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            clickedBtn.classList.add('active');
            
            // Update description
            const description = clickedBtn.getAttribute('data-description');
            const descElement = document.getElementById(`desc-${topicId}`);
            descElement.innerHTML = description;
            
            // Update scores
            if (previousLevel !== null) {
                if (previousLevel === 0) {
                    categoryScores[category].naCount--;
                } else {
                    categoryScores[category].total -= previousLevel;
                }
            }
            
            if (level === 0) {
                categoryScores[category].naCount++;
            } else {
                categoryScores[category].total += level;
            }
            
            updateDashboard();
        }

        function updateDashboard() {
            let totalScore = 0;
            let totalTopics = 0;
            let totalNACount = 0;
            
            Object.keys(categoryScores).forEach(category => {
                const applicableCount = categoryScores[category].count - categoryScores[category].naCount;
                totalScore += categoryScores[category].total;
                totalTopics += applicableCount;
                totalNACount += categoryScores[category].naCount;
            });
            
            const averageScore = totalTopics > 0 ? (totalScore / totalTopics).toFixed(2) : 0;
            const completedTopics = Object.values(assessmentState).filter(v => v !== null).length;
            const totalPossibleTopics = Object.values(assessmentState).length;
            const completionPercentage = ((completedTopics / totalPossibleTopics) * 100).toFixed(0);
            
            document.getElementById('overallScore').textContent = averageScore;
            
            let levelName = 'Not Started';
            if (averageScore >= 3.5) levelName = '‚≠ê‚≠ê‚≠ê‚≠ê Leading';
            else if (averageScore >= 2.5) levelName = '‚≠ê‚≠ê‚≠ê Mastering';
            else if (averageScore >= 1.5) levelName = '‚≠ê‚≠ê Growing';
            else if (averageScore > 0) levelName = '‚≠ê Starting';
            
            document.getElementById('overallLevel').innerHTML = `${levelName}<br><span class="completion-badge">${completionPercentage}% Complete</span>`;
            
            // Update category stats
            const statsContainer = document.getElementById('categoryStats');
            statsContainer.innerHTML = '';
            
            Object.keys(categoryScores).forEach(category => {
                const score = categoryScores[category];
                const applicableCount = score.count - score.naCount;
                const avgCategoryScore = applicableCount > 0 ? (score.total / applicableCount) : 0;
                const percentage = (avgCategoryScore / 4) * 100;
                
                const statItem = document.createElement('div');
                statItem.className = 'stat-item';
                statItem.innerHTML = `
                    <div class="stat-header">
                        <span class="stat-name">${category}</span>
                        <span class="stat-value">${avgCategoryScore.toFixed(2)} / 4.0</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${percentage}%"></div>
                    </div>
                `;
                statsContainer.appendChild(statItem);
            });
        }

        // Function to generate spider chart
        function generateSpiderChart() {
            const canvas = document.getElementById('spiderChartCanvas');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Get category scores
            const categories = Object.keys(categoryScores);
            const scores = categories.map(cat => {
                const score = categoryScores[cat];
                const applicableCount = score.count - score.naCount;
                return applicableCount > 0 ? (score.total / applicableCount) : 0;
            });
            
            // Chart settings
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 150;
            const levels = 5; // 0 to 4
            
            // Draw background circles
            ctx.strokeStyle = '#e8e8e8';
            ctx.lineWidth = 1;
            for (let i = 1; i <= levels; i++) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, (radius / levels) * i, 0, 2 * Math.PI);
                ctx.stroke();
            }
            
            // Draw axes
            const angleStep = (2 * Math.PI) / categories.length;
            ctx.strokeStyle = '#d0d0d0';
            ctx.lineWidth = 1;
            
            for (let i = 0; i < categories.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);
                
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
            }
            
            // Draw data polygon
            ctx.fillStyle = 'rgba(201, 169, 97, 0.3)';
            ctx.strokeStyle = 'rgba(201, 169, 97, 1)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            for (let i = 0; i < categories.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const score = scores[i];
                const distance = (score / 4) * radius;
                const x = centerX + distance * Math.cos(angle);
                const y = centerY + distance * Math.sin(angle);
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            
            // Draw points
            ctx.fillStyle = '#c9a961';
            for (let i = 0; i < categories.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const score = scores[i];
                const distance = (score / 4) * radius;
                const x = centerX + distance * Math.cos(angle);
                const y = centerY + distance * Math.sin(angle);
                
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            // Add labels
            ctx.fillStyle = '#1a2332';
            ctx.font = 'bold 11px Arial';
            ctx.textAlign = 'center';
            
            for (let i = 0; i < categories.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const labelDistance = radius + 30;
                const x = centerX + labelDistance * Math.cos(angle);
                const y = centerY + labelDistance * Math.sin(angle);
                
                // Shorten category names for display
                const shortName = categories[i].split('/')[0].trim();
                ctx.fillText(shortName, x, y);
                ctx.font = '9px Arial';
                ctx.fillText(scores[i].toFixed(1), x, y + 12);
                ctx.font = 'bold 11px Arial';
            }
            
            return canvas.toDataURL('image/png');
        }

        async function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            const pageWidth = pdf.internal.pageSize.getWidth();
            const pageHeight = pdf.internal.pageSize.getHeight();
            const margin = 15;
            let yPosition = margin;
        
            // Add header with logo (smaller)
            pdf.setFillColor(26, 35, 50);
            pdf.rect(0, 0, pageWidth, 30, 'F');
            
            // Add logo image (smaller)
            const logoImg = document.getElementById('atlasLogo');
            if (logoImg && logoImg.complete) {
                try {
                    const canvas = document.createElement('canvas');
                    canvas.width = logoImg.naturalWidth;
                    canvas.height = logoImg.naturalHeight;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(logoImg, 0, 0);
                    const imgData = canvas.toDataURL('image/png');
                    
                    // Smaller logo
                    pdf.addImage(imgData, 'PNG', margin, 5, 25, 20);
                } catch (error) {
                    console.error('Error adding logo to PDF:', error);
                }
            }
            
            pdf.setTextColor(255, 255, 255);
            pdf.setFontSize(22);
            pdf.text('ATLAS', margin + 35, 14);
            
            pdf.setFontSize(10);
            pdf.text('Assessment Tool and Levers for Agile Success', margin + 35, 22);
            
            // Add date
            const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            pdf.setFontSize(9);
            pdf.text(today, pageWidth - margin - 40, 20);
        
            yPosition = 40;

            // Overall Score Section
            pdf.setFillColor(26, 35, 50);
            pdf.roundedRect(margin, yPosition, pageWidth - 2*margin, 35, 3, 3, 'F');
            
            pdf.setTextColor(255, 255, 255);
            pdf.setFontSize(12);
            pdf.text('OVERALL MATURITY SCORE', pageWidth/2, yPosition + 10, { align: 'center' });
            
            const overallScore = document.getElementById('overallScore').textContent;
            pdf.setFontSize(36);
            pdf.setTextColor(201, 169, 97);
            pdf.text(overallScore, pageWidth/2, yPosition + 25, { align: 'center' });
            
            yPosition += 45;

            // Add Spider Chart
            const spiderChartImg = generateSpiderChart();
            pdf.addImage(spiderChartImg, 'PNG', (pageWidth - 100) / 2, yPosition, 100, 100);
            yPosition += 110;

            // Category Scores with averages
            pdf.setFontSize(16);
            pdf.setTextColor(26, 35, 50);
            pdf.text('Category Performance', margin, yPosition);
            yPosition += 10;

            Object.keys(categoryScores).forEach(category => {
                if (yPosition > pageHeight - 30) {
                    pdf.addPage();
                    yPosition = margin;
                }

                const score = categoryScores[category];
                const applicableCount = score.count - score.naCount;
                const avgScore = applicableCount > 0 ? (score.total / applicableCount).toFixed(2) : 'N/A';
                const percentage = applicableCount > 0 ? (score.total / applicableCount / 4 * 100) : 0;

                pdf.setFontSize(11);
                pdf.setTextColor(26, 35, 50);
                pdf.text(category, margin, yPosition);
                
                pdf.setFontSize(10);
                pdf.setTextColor(201, 169, 97);
                const scoreText = avgScore !== 'N/A' ? `${avgScore} / 4.0` : 'N/A';
                pdf.text(scoreText, pageWidth - margin - 25, yPosition);

                yPosition += 5;

                // Progress bar
                pdf.setFillColor(232, 232, 232);
                pdf.roundedRect(margin, yPosition, pageWidth - 2*margin, 6, 2, 2, 'F');
                
                if (avgScore !== 'N/A') {
                    pdf.setFillColor(201, 169, 97);
                    const barWidth = (pageWidth - 2*margin) * (percentage / 100);
                    if (barWidth > 0) {
                        pdf.roundedRect(margin, yPosition, barWidth, 6, 2, 2, 'F');
                    }
                }

                yPosition += 12;
            });

            // Assessment Details with full definitions
            yPosition += 10;
            if (yPosition > pageHeight - 40) {
                pdf.addPage();
                yPosition = margin;
            }

            pdf.setFontSize(16);
            pdf.setTextColor(26, 35, 50);
            pdf.text('Detailed Assessment', margin, yPosition);
            yPosition += 10;

            Object.keys(assessmentData).forEach(category => {
                if (yPosition > pageHeight - 30) {
                    pdf.addPage();
                    yPosition = margin;
                }

                // Category header with average
                const score = categoryScores[category];
                const applicableCount = score.count - score.naCount;
                const avgScore = applicableCount > 0 ? (score.total / applicableCount).toFixed(2) : 'N/A';
                
                pdf.setFillColor(26, 35, 50);
                pdf.roundedRect(margin, yPosition, pageWidth - 2*margin, 10, 2, 2, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(12);
                pdf.text(category, margin + 5, yPosition + 7);
                
                // Add average to category header
                pdf.setTextColor(201, 169, 97);
                pdf.text(`Avg: ${avgScore}`, pageWidth - margin - 25, yPosition + 7);
                
                yPosition += 15;

                assessmentData[category].forEach((topic, topicIndex) => {
                    const topicId = `${category}-${topicIndex}`;
                    const selectedLevel = assessmentState[topicId];

                    if (yPosition > pageHeight - 50) {
                        pdf.addPage();
                        yPosition = margin;
                    }

                    // Topic name and score
                    pdf.setFontSize(10);
                    pdf.setTextColor(26, 35, 50);
                    pdf.setFont(undefined, 'bold');
                    pdf.text(`‚Ä¢ ${topic.name}`, margin + 5, yPosition);
                    pdf.setFont(undefined, 'normal');
                    
                    if (selectedLevel !== null) {
                        if (selectedLevel === 0) {
                            pdf.setTextColor(150, 150, 150);
                            pdf.text('N/A', pageWidth - margin - 20, yPosition);
                        } else {
                            const levelNames = ['Starting ‚≠ê', 'Growing ‚≠ê‚≠ê', 'Mastering ‚≠ê‚≠ê‚≠ê', 'Leading ‚≠ê‚≠ê‚≠ê‚≠ê'];
                            pdf.setTextColor(201, 169, 97);
                            pdf.text(levelNames[selectedLevel - 1], pageWidth - margin - 40, yPosition);
                        }
                    } else {
                        pdf.setTextColor(150, 150, 150);
                        pdf.text('Not assessed', pageWidth - margin - 30, yPosition);
                    }

                    yPosition += 6;
                    
                    // Add full definition of selected level
                    if (selectedLevel !== null && selectedLevel > 0) {
                        pdf.setFontSize(8);
                        pdf.setTextColor(100, 100, 100);
                        const definition = topic.levels[selectedLevel - 1];
                        const lines = pdf.splitTextToSize(definition, pageWidth - 2*margin - 10);
                        
                        lines.forEach(line => {
                            if (yPosition > pageHeight - 15) {
                                pdf.addPage();
                                yPosition = margin;
                            }
                            pdf.text(line, margin + 10, yPosition);
                            yPosition += 4;
                        });
                        
                        yPosition += 2;
                    } else if (selectedLevel === 0) {
                        pdf.setFontSize(8);
                        pdf.setTextColor(150, 150, 150);
                        pdf.setFont(undefined, 'italic');
                        pdf.text('Not applicable to this organization', margin + 10, yPosition);
                        pdf.setFont(undefined, 'normal');
                        yPosition += 6;
                    }
                });

                yPosition += 5;
            });

            // Save PDF
            const timestamp = new Date().toISOString().split('T')[0];
            pdf.save(`ATLAS_Assessment_Report_${timestamp}.pdf`);
        }

        // Initialize on page load
        window.onload = initializeAssessment;
    </script>
</body>
</html>

